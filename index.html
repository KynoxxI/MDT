<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>LSPD Mobile Data Terminal</title>
  <link rel="stylesheet" href="styles.css"/>
  <meta name="color-scheme" content="dark">
</head>
<body>
  <div id="app">
    <!-- Barre lat√©rale -->
    <aside class="sidebar">
      <div class="brand">
        <span class="brand-badge">LSPD</span>
        <span class="brand-title">Mobile Data Terminal</span>
      </div>
      <nav class="nav">
        <button data-route="dashboard" class="nav-item active">Dashboard</button>
        <button data-route="citizens" class="nav-item">Citoyens</button>
        <button data-route="vehicles" class="nav-item">V√©hicules</button>
        <button data-route="cases" class="nav-item">Dossiers</button>
        <button data-route="warrants" class="nav-item">Mandats</button>
        <button data-route="reports" class="nav-item">Rapports</button>
        <button data-route="admin" class="nav-item role-admin">Administration</button>
      </nav>
      <div class="sidebar-bottom">
        <div class="user-info">
          <div class="avatar" id="user-avatar">üëÆ</div>
          <div>
            <div id="user-name">Invit√©</div>
            <div id="user-role" class="role">‚Äî</div>
          </div>
        </div>
        <button id="logout" class="logout">D√©connexion</button>
      </div>
    </aside>

    <!-- Contenu principal -->
    <main class="main">
      <header class="topbar">
        <div class="search">
          <input id="global-search" type="text" placeholder="Recherche globale‚Ä¶"/>
          <button id="search-btn">Rechercher</button>
        </div>
        <div class="top-actions">
          <button id="quick-create" class="primary">+ Nouveau rapport</button>
        </div>
      </header>

      <section id="view" class="view"></section>
    </main>
  </div>

  <!-- Modale g√©n√©rique -->
  <div id="modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modal-title">Titre</h3>
        <button id="modal-close" class="icon">‚úï</button>
      </div>
      <div id="modal-body" class="modal-body"></div>
      <div class="modal-footer">
        <button id="modal-cancel">Annuler</button>
        <button id="modal-confirm" class="primary">Confirmer</button>
      </div>
    </div>
    <div class="modal-backdrop"></div>
  </div>

  <!-- √âcran de connexion -->
  <div id="login-screen" class="login-screen">
    <form id="login-form" class="login-card">
      <h2>Connexion MDT</h2>

      <div class="card soft">
        <p class="hint">Connexion recommand√©e via Discord (OAuth2)</p>
        <a id="discord-login-link" href="#" rel="noopener">
          <button type="button" class="primary" style="width: 100%;">Connexion via Discord</button>
        </a>
        <p id="discord-status" class="hint" style="margin-top: 8px;">Statut: En attente</p>
      </div>

      <div class="divider"></div>

      <p class="hint">Mode d√©mo (local) ‚Äî n‚Äôimporte quel identifiant/mot de passe est accept√©.</p>
      <label>Identifiant
        <input name="username" required placeholder="ex: j.doe"/>
      </label>
      <label>Mot de passe
        <input name="password" type="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢"/>
      </label>
      <label>R√¥le
        <select name="role">
          <option value="officer">Agent</option>
          <option value="sergeant">Sergent</option>
          <option value="detective">D√©tective</option>
          <option value="admin">Administrateur</option>
        </select>
      </label>
      <button type="submit" class="primary">Se connecter</button>
    </form>
  </div>

  <!-- Config OAuth Discord c√¥t√© front (le code √©change n√©cessite un backend) -->
  <script>
    const DISCORD_CLIENT_ID = '1445998594955022408';
    const REDIRECT_URI = 'https://kynoxxi.github.io/MDT/'; // doit correspondre au Developer Portal

    const oauthAuthorizeURL = new URL('https://discord.com/oauth2/authorize');
    oauthAuthorizeURL.searchParams.set('client_id', DISCORD_CLIENT_ID);
    oauthAuthorizeURL.searchParams.set('redirect_uri', REDIRECT_URI);
    oauthAuthorizeURL.searchParams.set('response_type', 'code');
    oauthAuthorizeURL.searchParams.set('scope', 'identify');

    const discordLink = document.getElementById('discord-login-link');
    discordLink.href = oauthAuthorizeURL.toString();

    const params = new URLSearchParams(location.search);
    const code = params.get('code');
    const discordStatus = document.getElementById('discord-status');
    if (discordStatus) {
      if (code) {
        discordStatus.textContent = 'Statut: Code re√ßu de Discord ‚úî ‚Äî √©change √† impl√©menter c√¥t√© serveur';
      } else {
        discordStatus.textContent = 'Statut: En attente ‚Äî clique sur ‚ÄúConnexion via Discord‚Äù';
      }
    }
  </script>

  <script src="app.js"></script>
</body>
</html>
